---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const docs = await getCollection('docs');
const blogs = await getCollection('blogs');

const sortedDocs = [...docs].sort((a, b) => a.id.localeCompare(b.id));

const sidebarItems = [
  ...docs.map((d) => {
    const s = d.id.replace(/\.md$/, '');
    return { href: `/docs/${s}`, label: d.data.title ?? s, active: false };
  }),
  ...blogs.map((b) => {
    const s = b.id.replace(/\.md$/, '');
    return { href: `/blogs/${s}`, label: b.data.title ?? s, active: false };
  }),
];
---

<Layout title="Documentation" sidebarItems={sidebarItems} currentSection="docs">
  <div class="prose dark:prose-invert max-w-none">
    <h1>Documentation</h1>
    <p class="text-slate-600 dark:text-slate-400">
      Learn about Palmlist's architecture, product specification, use cases, and development conventions.
    </p>
    <h2>Documentation Index</h2>
    <ul class="space-y-2">
      {sortedDocs.map((d) => {
        const s = d.id.replace(/\.md$/, '');
        return (
          <li>
            <a href={`/docs/${s}`} class="text-blue-600 dark:text-blue-400 hover:underline font-medium">
              {d.data.title ?? s}
            </a>
          </li>
        );
      })}
    </ul>
  </div>
</Layout>
