---
/**
 * GitBook-style "On This Page" table of contents.
 * Renders H2/H3 headings from the current document with anchor links.
 * Pixel art aesthetic: black and white.
 */
interface Props {
  headings: { depth: number; slug: string; text: string }[];
}

const { headings } = Astro.props;
const filtered = headings.filter((h) => h.depth >= 2 && h.depth <= 3);
---

{filtered.length > 0 && (
  <aside
    class="hidden xl:block w-56 shrink-0 pl-8 pt-8"
    aria-label="On this page"
  >
    <nav class="sticky top-24">
      <h2 class="text-xs font-pixel uppercase tracking-wider mb-3" style="color: var(--pixel-muted);">
        On this page
      </h2>
      <ul class="space-y-2" style="border-left: 3px solid var(--pixel-border);">
        {filtered.map((h) => (
          <li
            class={`text-sm font-pixel-body ${
              h.depth === 3 ? 'pl-4' : 'pl-3'
            } -ml-px border-l-2 border-transparent hover:border-[var(--pixel-border)] transition`}
          >
            <a
              href={`#${h.slug}`}
              class="block py-0.5 hover:opacity-80 transition"
              style="color: var(--pixel-fg);"
            >
              {h.text}
            </a>
          </li>
        ))}
      </ul>
    </nav>
  </aside>
)}
