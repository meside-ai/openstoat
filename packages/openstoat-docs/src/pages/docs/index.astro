---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const docs = await getCollection('docs');
const blogs = await getCollection('blogs');

const sortedDocs = [...docs].sort((a, b) => a.id.localeCompare(b.id));

const sidebarItems = [
  ...docs.map((d) => {
    const s = d.id.replace(/\.md$/, '');
    return { href: `/docs/${s}`, label: d.data.title ?? s, active: false };
  }),
  ...blogs.map((b) => {
    const s = b.id.replace(/\.md$/, '');
    return { href: `/blogs/${s}`, label: b.data.title ?? s, active: false };
  }),
];
---

<Layout title="Documentation" sidebarItems={sidebarItems} currentSection="docs">
  <div class="prose dark:prose-invert max-w-none" style="color: var(--pixel-fg);">
    <h1 class="font-pixel text-lg" style="color: var(--pixel-fg);">Documentation</h1>
    <p class="font-pixel-body" style="color: var(--pixel-muted);">
      Learn about OpenStoat's architecture, product specification, use cases, and development conventions.
    </p>
    <h2 class="font-pixel text-sm mt-6" style="color: var(--pixel-fg);">Documentation Index</h2>
    <ul class="space-y-2 mt-4">
      {sortedDocs.map((d) => {
        const s = d.id.replace(/\.md$/, '');
        return (
          <li>
            <a
              href={`/docs/${s}`}
              class="font-pixel-body underline hover:no-underline transition"
              style="color: var(--pixel-fg); text-underline-offset: 4px;"
            >
              {d.data.title ?? s}
            </a>
          </li>
        );
      })}
    </ul>
  </div>
</Layout>
